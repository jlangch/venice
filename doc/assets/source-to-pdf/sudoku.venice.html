<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta name="author" content=""/>
        <meta charset="UTF-8"/>
       
        <title>Source Code</title>
        
        <style>
            
            /* see https://fonts.google.com/ */ 
            @import url('https://fonts.googleapis.com/css?family=Audiowide|Open+Sans|JetBrains+Mono&display=swap');
            
           
            
            
            @page {
                size: A4 portrait;
                margin: 1.4cm 1cm 1.4cm 1cm;
                padding: 0;
                @bottom-left { content: element(footer_left); }
                @bottom-right { content: element(footer_right); }
            }
            
            span.page:before {
                content: counter(page);
            }
            
            span.pagecount:before {
                content: counter(pages);
            }
            
            #footer_left {
                color: #8080;
                position: running(footer_left);
                text-align: left;
                padding-left: 2mm;
            }
            
            #footer_right {
                color: #8080;
                position: running(footer_right);
                text-align: right;
                padding-right: 2mm;
            }
            
            body {
                background-color: white;
                font-family: 'Open Sans', sans-serif;
                color: #444;
                font-size: 14px;
                line-height: 1.4em;
                font-weight: 400;
            }
            
            hr {
               border: none;
               height: 1px;
               background-color: #FFFFFF;
            }
             
            code {
                margin-left: 3em;
                display: block;
                white-space: pre-wrap;
                font-family: 'JetBrains Mono', sans-serif;
                font-weight: 400;
            }
        </style>
    </head>
    
    <body>
         <!-- Footer -->
         <div id="footer_left"><hr/>sudoku.venice</div>
         <div id="footer_right"><hr/><span class="page"/> / <span class="pagecount"/></div>

         <code><span style="color: #808080">0001   </span><span style="color: #808080">;;;;   __    __         _</span>
<span style="color: #808080">0002   </span><span style="color: #808080">;;;;   \ \  / /__ _ __ (_) ___ ___</span>
<span style="color: #808080">0003   </span><span style="color: #808080">;;;;    \ \/ / _ \ &apos;_ \| |/ __/ _ \</span>
<span style="color: #808080">0004   </span><span style="color: #808080">;;;;     \  /  __/ | | | | (_|  __/</span>
<span style="color: #808080">0005   </span><span style="color: #808080">;;;;      \/ \___|_| |_|_|\___\___|</span>
<span style="color: #808080">0006   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0007   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0008   </span><span style="color: #808080">;;;; Copyright 2017-2024 Venice</span>
<span style="color: #808080">0009   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0010   </span><span style="color: #808080">;;;; Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span style="color: #808080">0011   </span><span style="color: #808080">;;;; you may not use this file except in compliance with the License.</span>
<span style="color: #808080">0012   </span><span style="color: #808080">;;;; You may obtain a copy of the License at</span>
<span style="color: #808080">0013   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0014   </span><span style="color: #808080">;;;;     http://www.apache.org/licenses/LICENSE-2.0</span>
<span style="color: #808080">0015   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0016   </span><span style="color: #808080">;;;; Unless required by applicable law or agreed to in writing, software</span>
<span style="color: #808080">0017   </span><span style="color: #808080">;;;; distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span style="color: #808080">0018   </span><span style="color: #808080">;;;; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span style="color: #808080">0019   </span><span style="color: #808080">;;;; See the License for the specific language governing permissions and</span>
<span style="color: #808080">0020   </span><span style="color: #808080">;;;; limitations under the License.</span>
<span style="color: #808080">0021   </span>
<span style="color: #808080">0022   </span><span style="color: #808080">;;;; Sudoku solver</span>
<span style="color: #808080">0023   </span>
<span style="color: #808080">0024   </span><span style="color: #808080">;;;; Constraints for a 9x9 Sudoku</span>
<span style="color: #808080">0025   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0026   </span><span style="color: #808080">;;;; Constraint 1: Each cell should be filled with a single value between 1</span>
<span style="color: #808080">0027   </span><span style="color: #808080">;;;;               and 9</span>
<span style="color: #808080">0028   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0029   </span><span style="color: #808080">;;;; Constraint 2: Each row should contain every number from 1 to 9 once</span>
<span style="color: #808080">0030   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0031   </span><span style="color: #808080">;;;; Constraint 3: Each column should contain every number from 1 to 9 once</span>
<span style="color: #808080">0032   </span><span style="color: #808080">;;;;</span>
<span style="color: #808080">0033   </span><span style="color: #808080">;;;; Constraint 4: Each 3x3 grid, starting from top left, should contain every</span>
<span style="color: #808080">0034   </span><span style="color: #808080">;;;;               number from 1 to 9 once</span>
<span style="color: #808080">0035   </span>
<span style="color: #808080">0036   </span><span style="color: #404040">(</span><span style="color: #9932CC">do</span>
<span style="color: #808080">0037   </span>  <span style="color: #404040">(</span><span style="color: #9932CC">def</span> <span style="color: #404040">board-1</span> <span style="color: #404040">[</span><span style="color: #404040">[</span><span style="color: #E9967A">7</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0038   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">5</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">9</span><span style="color: #404040">]</span>
<span style="color: #808080">0039   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">8</span><span style="color: #404040">]</span>
<span style="color: #808080">0040   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0041   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">5</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">3</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0042   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">9</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">5</span><span style="color: #404040">]</span>
<span style="color: #808080">0043   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">3</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">2</span><span style="color: #404040">]</span>
<span style="color: #808080">0044   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">1</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0045   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span><span style="color: #404040">]</span><span style="color: #404040">]</span><span style="color: #404040">)</span>
<span style="color: #808080">0046   </span>
<span style="color: #808080">0047   </span>  <span style="color: #404040">(</span><span style="color: #9932CC">def</span> <span style="color: #404040">board-2</span> <span style="color: #404040">[</span><span style="color: #404040">[</span><span style="color: #E9967A">5</span> <span style="color: #E9967A">3</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0048   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">5</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0049   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0050   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">3</span><span style="color: #404040">]</span>
<span style="color: #808080">0051   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">4</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">3</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span><span style="color: #404040">]</span>
<span style="color: #808080">0052   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">7</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span><span style="color: #404040">]</span>
<span style="color: #808080">0053   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0054   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">5</span><span style="color: #404040">]</span>
<span style="color: #808080">0055   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">9</span><span style="color: #404040">]</span><span style="color: #404040">]</span><span style="color: #404040">)</span>
<span style="color: #808080">0056   </span>
<span style="color: #808080">0057   </span>  <span style="color: #404040">(</span><span style="color: #9932CC">def</span> <span style="color: #404040">board-3</span> <span style="color: #404040">[</span><span style="color: #404040">[</span><span style="color: #E9967A">5</span> <span style="color: #E9967A">3</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0058   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">5</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0059   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0060   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">3</span><span style="color: #404040">]</span>
<span style="color: #808080">0061   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">4</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">3</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span><span style="color: #404040">]</span>
<span style="color: #808080">0062   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">7</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span><span style="color: #404040">]</span>
<span style="color: #808080">0063   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0064   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">5</span><span style="color: #404040">]</span>
<span style="color: #808080">0065   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span><span style="color: #404040">]</span><span style="color: #404040">)</span>
<span style="color: #808080">0066   </span>
<span style="color: #808080">0067   </span>  <span style="color: #404040">(</span><span style="color: #9932CC">def</span> <span style="color: #404040">board-4</span> <span style="color: #404040">[</span><span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">2</span><span style="color: #404040">]</span>   <span style="color: #808080">;; platinum blonde</span>
<span style="color: #808080">0068   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">3</span><span style="color: #404040">]</span>
<span style="color: #808080">0069   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">2</span> <span style="color: #E9967A">3</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0070   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">5</span><span style="color: #404040">]</span>
<span style="color: #808080">0071   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0072   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">9</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0073   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">8</span> <span style="color: #E9967A">5</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0074   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">9</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">4</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">5</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span>
<span style="color: #808080">0075   </span>                <span style="color: #404040">[</span><span style="color: #E9967A">4</span> <span style="color: #E9967A">7</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">6</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span> <span style="color: #E9967A">0</span><span style="color: #404040">]</span><span style="color: #404040">]</span><span style="color: #404040">)</span>
<span style="color: #808080">0076   </span>
<span style="color: #808080">0077   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">defn</span> <span style="color: #404040">read-board</span> <span style="color: #404040">[</span><span style="color: #404040">s</span><span style="color: #404040">]</span>
<span style="color: #808080">0078   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">vector*</span> <span style="color: #404040">(</span><span style="color: #4169E1">-&gt;&gt;</span> <span style="color: #404040">(</span><span style="color: #4169E1">seq</span> <span style="color: #404040">s</span><span style="color: #404040">)</span>
<span style="color: #808080">0079   </span>                  <span style="color: #404040">(</span><span style="color: #4169E1">replace</span> <span style="color: #404040">{</span><span style="color: #404040">#\.</span> <span style="color: #404040">#\0</span><span style="color: #404040">}</span><span style="color: #404040">)</span>
<span style="color: #808080">0080   </span>                  <span style="color: #404040">(</span><span style="color: #4169E1">map</span> <span style="color: #404040">#</span><span style="color: #404040">(</span><span style="color: #4169E1">-</span> <span style="color: #404040">(</span><span style="color: #4169E1">long</span> <span style="color: #404040">%</span><span style="color: #404040">)</span> <span style="color: #404040">(</span><span style="color: #4169E1">long</span> <span style="color: #404040">#\0</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0081   </span>                  <span style="color: #404040">(</span><span style="color: #4169E1">partition</span> <span style="color: #E9967A">9</span><span style="color: #404040">)</span>
<span style="color: #808080">0082   </span>                  <span style="color: #404040">(</span><span style="color: #4169E1">map</span> <span style="color: #404040">vector*</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0083   </span>
<span style="color: #808080">0084   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">defn</span> <span style="color: #404040">read-boards</span> <span style="color: #404040">[</span><span style="color: #404040">file</span><span style="color: #404040">]</span>
<span style="color: #808080">0085   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">-&gt;&gt;</span> <span style="color: #404040">(</span><span style="color: #4169E1">io/slurp-lines</span> <span style="color: #404040">file</span><span style="color: #404040">)</span>
<span style="color: #808080">0086   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">map</span> <span style="color: #404040">read-board</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0087   </span>
<span style="color: #808080">0088   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">defn</span> <span style="color: #404040">print-board</span> <span style="color: #404040">[</span><span style="color: #404040">board</span><span style="color: #404040">]</span>
<span style="color: #808080">0089   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">println</span><span style="color: #404040">)</span>
<span style="color: #808080">0090   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">-&gt;&gt;</span> <span style="color: #404040">(</span><span style="color: #4169E1">postwalk-replace</span> <span style="color: #404040">{</span><span style="color: #E9967A">0</span> <span style="color: #2E8B57">&quot;·&quot;</span><span style="color: #404040">}</span> <span style="color: #404040">board</span><span style="color: #404040">)</span>
<span style="color: #808080">0091   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">map</span> <span style="color: #404040">#</span><span style="color: #404040">(</span><span style="color: #4169E1">flatten</span> <span style="color: #404040">(</span><span style="color: #4169E1">interpose</span> <span style="color: #2E8B57">&quot;|&quot;</span> <span style="color: #404040">(</span><span style="color: #4169E1">partition</span> <span style="color: #E9967A">3</span> <span style="color: #404040">%</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0092   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">partition</span> <span style="color: #E9967A">3</span><span style="color: #404040">)</span>
<span style="color: #808080">0093   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">interpose</span> <span style="color: #404040">(</span><span style="color: #4169E1">seq</span> <span style="color: #2E8B57">&quot;---+---+---&quot;</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0094   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">flatten</span><span style="color: #404040">)</span>
<span style="color: #808080">0095   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">partition</span> <span style="color: #E9967A">11</span><span style="color: #404040">)</span>
<span style="color: #808080">0096   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">docoll</span> <span style="color: #404040">#</span><span style="color: #404040">(</span><span style="color: #4169E1">apply</span> <span style="color: #404040">println</span> <span style="color: #404040">%</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0097   </span>
<span style="color: #808080">0098   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">defn</span> <span style="color: #404040">first-empty-cell</span> <span style="color: #404040">[</span><span style="color: #404040">board</span><span style="color: #404040">]</span>
<span style="color: #808080">0099   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">first</span> <span style="color: #404040">(</span><span style="color: #4169E1">list-comp</span> <span style="color: #404040">[</span><span style="color: #404040">x</span> <span style="color: #404040">(</span><span style="color: #4169E1">range</span> <span style="color: #E9967A">9</span><span style="color: #404040">)</span>
<span style="color: #808080">0100   </span>                       <span style="color: #404040">y</span> <span style="color: #404040">(</span><span style="color: #4169E1">range</span> <span style="color: #E9967A">9</span><span style="color: #404040">)</span>
<span style="color: #808080">0101   </span>                       <span style="color: #E9967A">:when</span> <span style="color: #404040">(</span><span style="color: #4169E1">==</span> <span style="color: #E9967A">0</span> <span style="color: #404040">(</span><span style="color: #4169E1">get-in</span> <span style="color: #404040">board</span> <span style="color: #404040">[</span><span style="color: #404040">y</span> <span style="color: #404040">x</span><span style="color: #404040">]</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">]</span>
<span style="color: #808080">0102   </span>                      <span style="color: #404040">[</span><span style="color: #404040">x</span> <span style="color: #404040">y</span><span style="color: #404040">]</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0103   </span>
<span style="color: #808080">0104   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">defn</span> <span style="color: #404040">value-not-used?</span> <span style="color: #404040">[</span><span style="color: #404040">val</span> <span style="color: #404040">coll</span><span style="color: #404040">]</span>
<span style="color: #808080">0105   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">nil?</span> <span style="color: #404040">(</span><span style="color: #4169E1">some</span> <span style="color: #404040">#</span><span style="color: #404040">{</span><span style="color: #404040">val</span><span style="color: #404040">}</span> <span style="color: #404040">coll</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0106   </span>
<span style="color: #808080">0107   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">defn</span> <span style="color: #404040">grid-3x3-vals</span> <span style="color: #404040">[</span><span style="color: #404040">board</span> <span style="color: #404040">x</span> <span style="color: #404040">y</span><span style="color: #404040">]</span>
<span style="color: #808080">0108   </span>    <span style="color: #404040">(</span><span style="color: #9932CC">let</span> <span style="color: #404040">[</span><span style="color: #404040">xs</span>  <span style="color: #404040">(</span><span style="color: #4169E1">-&gt;</span> <span style="color: #404040">x</span> <span style="color: #404040">(</span><span style="color: #4169E1">/</span> <span style="color: #E9967A">3</span><span style="color: #404040">)</span> <span style="color: #404040">(</span><span style="color: #4169E1">*</span> <span style="color: #E9967A">3</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0109   </span>          <span style="color: #404040">ys</span>  <span style="color: #404040">(</span><span style="color: #4169E1">-&gt;</span> <span style="color: #404040">y</span> <span style="color: #404040">(</span><span style="color: #4169E1">/</span> <span style="color: #E9967A">3</span><span style="color: #404040">)</span> <span style="color: #404040">(</span><span style="color: #4169E1">*</span> <span style="color: #E9967A">3</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">]</span>
<span style="color: #808080">0110   </span>      <span style="color: #404040">(</span><span style="color: #4169E1">list-comp</span> <span style="color: #404040">[</span><span style="color: #404040">x1</span> <span style="color: #404040">(</span><span style="color: #4169E1">range</span> <span style="color: #404040">xs</span> <span style="color: #404040">(</span><span style="color: #4169E1">+</span> <span style="color: #404040">xs</span> <span style="color: #E9967A">3</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0111   </span>                  <span style="color: #404040">y1</span> <span style="color: #404040">(</span><span style="color: #4169E1">range</span> <span style="color: #404040">ys</span> <span style="color: #404040">(</span><span style="color: #4169E1">+</span> <span style="color: #404040">ys</span> <span style="color: #E9967A">3</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">]</span>
<span style="color: #808080">0112   </span>        <span style="color: #404040">(</span><span style="color: #4169E1">get-in</span> <span style="color: #404040">board</span> <span style="color: #404040">[</span><span style="color: #404040">y1</span> <span style="color: #404040">x1</span><span style="color: #404040">]</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0113   </span>
<span style="color: #808080">0114   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">defn</span> <span style="color: #404040">possible?</span> <span style="color: #404040">[</span><span style="color: #404040">board</span> <span style="color: #404040">x</span> <span style="color: #404040">y</span> <span style="color: #404040">val</span><span style="color: #404040">]</span>
<span style="color: #808080">0115   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">and</span> <span style="color: #404040">(</span><span style="color: #4169E1">==</span> <span style="color: #E9967A">0</span> <span style="color: #404040">(</span><span style="color: #4169E1">get-in</span> <span style="color: #404040">board</span> <span style="color: #404040">[</span><span style="color: #404040">y</span> <span style="color: #404040">x</span><span style="color: #404040">]</span><span style="color: #404040">)</span><span style="color: #404040">)</span>                         <span style="color: #808080">; cell [x y]</span>
<span style="color: #808080">0116   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">value-not-used?</span> <span style="color: #404040">val</span> <span style="color: #404040">(</span><span style="color: #4169E1">nth</span> <span style="color: #404040">board</span> <span style="color: #404040">y</span><span style="color: #404040">)</span><span style="color: #404040">)</span>                 <span style="color: #808080">; row y</span>
<span style="color: #808080">0117   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">value-not-used?</span> <span style="color: #404040">val</span> <span style="color: #404040">(</span><span style="color: #4169E1">map</span> <span style="color: #404040">#</span><span style="color: #404040">(</span><span style="color: #4169E1">nth</span> <span style="color: #404040">%</span> <span style="color: #404040">x</span><span style="color: #404040">)</span> <span style="color: #404040">board</span><span style="color: #404040">)</span><span style="color: #404040">)</span>        <span style="color: #808080">; col x</span>
<span style="color: #808080">0118   </span>         <span style="color: #404040">(</span><span style="color: #4169E1">value-not-used?</span> <span style="color: #404040">val</span> <span style="color: #404040">(</span><span style="color: #4169E1">grid-3x3-vals</span> <span style="color: #404040">board</span> <span style="color: #404040">x</span> <span style="color: #404040">y</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>   <span style="color: #808080">; 3x3 grid</span>
<span style="color: #808080">0119   </span>
<span style="color: #808080">0120   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">defn</span> <span style="color: #404040">solve</span> <span style="color: #404040">[</span><span style="color: #404040">board</span><span style="color: #404040">]</span>
<span style="color: #808080">0121   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">if-let</span> <span style="color: #404040">[</span><span style="color: #404040">[</span><span style="color: #404040">x</span> <span style="color: #404040">y</span><span style="color: #404040">]</span> <span style="color: #404040">(</span><span style="color: #4169E1">first-empty-cell</span> <span style="color: #404040">board</span><span style="color: #404040">)</span><span style="color: #404040">]</span>
<span style="color: #808080">0122   </span>      <span style="color: #404040">(</span><span style="color: #4169E1">list-comp</span> <span style="color: #404040">[</span><span style="color: #404040">v</span> <span style="color: #404040">(</span><span style="color: #4169E1">range</span> <span style="color: #E9967A">1</span> <span style="color: #E9967A">10</span><span style="color: #404040">)</span> <span style="color: #E9967A">:when</span> <span style="color: #404040">(</span><span style="color: #4169E1">possible?</span> <span style="color: #404040">board</span> <span style="color: #404040">x</span> <span style="color: #404040">y</span> <span style="color: #404040">v</span><span style="color: #404040">)</span><span style="color: #404040">]</span>
<span style="color: #808080">0123   </span>                 <span style="color: #404040">(</span><span style="color: #4169E1">solve</span> <span style="color: #404040">(</span><span style="color: #4169E1">assoc-in</span> <span style="color: #404040">board</span> <span style="color: #404040">[</span><span style="color: #404040">y</span> <span style="color: #404040">x</span><span style="color: #404040">]</span> <span style="color: #404040">v</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0124   </span>      <span style="color: #404040">(</span><span style="color: #4169E1">print-board</span> <span style="color: #404040">board</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0125   </span>
<span style="color: #808080">0126   </span>
<span style="color: #808080">0127   </span>  <span style="color: #404040">(</span><span style="color: #4169E1">when-not</span> <span style="color: #404040">(</span><span style="color: #9932CC">macroexpand-on-load?</span><span style="color: #404040">)</span>
<span style="color: #808080">0128   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">print-msg-box</span> <span style="color: #E9967A">:warn</span>
<span style="color: #808080">0129   </span>                   <span style="color: #2E8B57">&quot;&quot;&quot;
<span style="color: #808080">0130   </span>                   macroexpand-on-load is not activated. To get a better
<span style="color: #808080">0131   </span>                   performance activate it before loading this script.
<span style="color: #808080">0132   </span>
<span style="color: #808080">0133   </span>                   From the REPL run the command: !macroexpand
<span style="color: #808080">0134   </span>                   &quot;&quot;&quot;</span><span style="color: #404040">)</span><span style="color: #404040">)</span>
<span style="color: #808080">0135   </span>
<span style="color: #808080">0136   </span>  <span style="color: #404040">(</span><span style="color: #9932CC">let</span> <span style="color: #404040">[</span><span style="color: #404040">board</span> <span style="color: #404040">board-1</span><span style="color: #404040">]</span>
<span style="color: #808080">0137   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">print-board</span> <span style="color: #404040">board</span><span style="color: #404040">)</span>
<span style="color: #808080">0138   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">solve</span> <span style="color: #404040">board</span><span style="color: #404040">)</span>
<span style="color: #808080">0139   </span>    <span style="color: #404040">(</span><span style="color: #4169E1">println</span><span style="color: #404040">)</span><span style="color: #404040">)</span><span style="color: #404040">)</span></code>
    </body>
    
</html>